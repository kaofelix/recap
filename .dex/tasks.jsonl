{"id":"0wxb4fi9","parent_id":null,"name":"User-configurable syntax highlighting themes","description":"## Problem\nUsers may prefer different syntax highlighting themes based on personal preference.\n\n## Solution\nAdd a settings panel where users can choose from built-in Prism themes or community themes.\n\n## Options to consider\n1. **Built-in themes**: Tomorrow, Okaidia, Solarized, Twilight, etc.\n2. **Community themes**: Dracula, Nord, One Dark, Gruvbox\n3. **Custom theme editor**: Let users tweak colors (advanced)\n\n## Implementation ideas\n- Store preference in app settings (zustand persist)\n- Load theme CSS dynamically or use CSS custom properties\n- Preview theme before applying\n- Separate light/dark theme selection\n\n## Acceptance Criteria\n- User can select from at least 4-5 themes\n- Theme persists across sessions\n- Works with both light and dark app modes","priority":1,"completed":false,"result":null,"metadata":null,"created_at":"2026-02-09T21:30:16.637Z","updated_at":"2026-02-09T21:30:16.637Z","started_at":null,"completed_at":null,"blockedBy":[],"blocks":[],"children":[]}
{"id":"1851ztkf","parent_id":null,"name":"Foundation Setup","description":"Set up the foundational architecture for the code review app.\n\n## Goal\nEstablish the core infrastructure: styling, state management, layout, testing, and git integration.\n\n## Scope\n- Frontend: Tailwind CSS with theming, Zustand, Radix UI, resizable panels, diff viewer\n- Backend: git2 integration for reading repository data\n- Testing: Vitest + React Testing Library\n- Persistence: Tauri app data for repo list\n\n## Out of Scope\n- Actual features (commit browsing, diff viewing) - those come after foundation\n- E2E testing - unit tests first\n\n## Acceptance Criteria\n- 3-panel layout renders with resizable dividers\n- Light/dark/system theme switching works\n- At least one Tauri command (list commits) callable from frontend\n- Vitest runs with sample test passing","priority":1,"completed":true,"result":"Foundation setup complete. All 6 subtasks done:\n- Frontend dependencies installed (zustand, tailwind, radix, vitest, etc.)\n- Tailwind CSS with light/dark/system theming\n- Vitest testing infrastructure with Tauri mocks\n- 3-panel resizable layout shell\n- git2 backend with list_commits command\n- Zustand store for repo persistence\n\nReady for Phase 2: Core Features.","metadata":null,"created_at":"2026-02-08T17:33:16.992Z","updated_at":"2026-02-08T19:13:32.914Z","started_at":"2026-02-08T19:13:32.913Z","completed_at":"2026-02-08T19:13:32.914Z","blockedBy":[],"blocks":[],"children":["ipb6e2xv","sxfhtrlr","s26gk1l8","32s9h4re","i9mzuail","mkjgy2fg"]}
{"id":"1bqhvchx","parent_id":null,"name":"Changes view: show working directory changes","description":"## Problem\nCurrently can only view committed changes. Users need to see uncommitted working directory changes like GitHub Desktop's 'Changes' tab.\n\n## Solution\nAdd a 'Changes' view that shows modified/staged/untracked files in the working directory.\n\n## Implementation\n\n### Backend (Rust)\nAdd `get_working_changes(repo_path)` command returning:\n```rust\nstruct WorkingChanges {\n    files: Vec<ChangedFile>,  // reuse existing struct\n}\n```\n\nUse git2's `Repository::statuses()` to get working directory status.\n\n### Frontend\n1. Add view toggle in toolbar or sidebar: 'History' | 'Changes'\n2. When 'Changes' selected, show file list directly (no commit list)\n3. Clicking a file shows diff of working copy vs HEAD\n4. Add `get_working_file_diff(repo_path, file_path)` backend command\n\n### Store\n- Add `viewMode: 'history' | 'changes'`\n- When in changes mode, file list shows working changes instead of commit files\n\n## Acceptance Criteria\n- Can switch between History and Changes view\n- Changes view shows list of modified files\n- Clicking file shows diff against HEAD\n- Untracked files shown (marked appropriately)","priority":1,"completed":true,"result":"Implemented Changes view for working directory changes.\n\n## Backend (Rust)\n- Added `get_working_changes(repo_path)` using git2 Repository::statuses()\n- Added `get_working_file_diff(repo_path, file_path)` for diffing vs HEAD\n- Added `Untracked` variant to FileStatus enum\n- 10 new tests covering modified, untracked, staged, deleted files\n\n## Frontend  \n- Added `viewMode: 'history' | 'changes'` to store with `setViewMode()` action\n- Sidebar: Added History/Changes toggle buttons in header (like GitHub Desktop)\n- Changes view shows file list with status indicators (M, A, D, ?)\n- DiffView updated to fetch working directory diffs when in changes mode\n- AppLayout hides FileList panel in changes mode\n- Empty state shows 'No changes here... ✓'\n\n## Testing\n- 104 frontend tests passing (added 6 new tests)\n- 39 backend tests passing (added 10 new tests)\n- Manual testing verified toggle works, files display correctly, diffs render\n\n## Files changed\n- src-tauri/src/git.rs, lib.rs (backend)\n- src/store/appStore.ts (viewMode state)\n- src/components/Layout/Sidebar.tsx (view toggle + file list)\n- src/components/Layout/DiffView.tsx (working dir diff support)\n- src/components/Layout/AppLayout.tsx (conditional FileList panel)\n- src/types/file.ts (Untracked status)","metadata":{"commit":{"sha":"1e7a59df82ad555e6fe11500a1e0fb8a99090f5f","message":"feat: add Changes view for working directory changes","branch":"main","timestamp":"2026-02-09T00:58:58.823Z"}},"created_at":"2026-02-08T22:32:48.918Z","updated_at":"2026-02-09T00:58:58.826Z","started_at":"2026-02-09T00:58:58.824Z","completed_at":"2026-02-09T00:58:58.826Z","blockedBy":[],"blocks":["9ytgzrqz","ihdsm9qr"],"children":[]}
{"id":"2fijqgs9","parent_id":null,"name":"Repository picker: fuzzy search","description":"## Problem\nWith many repos, scrolling through the list is slow. Users want to type to filter.\n\n## Solution\nAdd a search input to the repo picker with fuzzy matching.\n\n## Implementation\n1. Add text input at top of picker popup\n2. Auto-focus input when popup opens\n3. Filter repos as user types using fuzzy match on name and path\n4. Keyboard navigation: arrow keys to move through filtered results, Enter to select\n5. Show 'No matches' when filter returns empty\n\n### Fuzzy Matching\nUse a lightweight fuzzy match library like `fuse.js` or implement simple substring/fuzzy match.\nMatch against both repo name and path.\n\n## Acceptance Criteria\n- Search input auto-focused on popup open\n- Typing filters the repo list\n- Fuzzy matching works (e.g., 'cr' matches 'code-review')\n- Arrow keys navigate filtered results\n- Enter selects highlighted repo\n- Escape clears search or closes popup","priority":1,"completed":false,"result":null,"metadata":null,"created_at":"2026-02-08T22:36:00.337Z","updated_at":"2026-02-08T22:36:38.528Z","started_at":null,"completed_at":null,"blockedBy":["8wgwdi46"],"blocks":[],"children":[]}
{"id":"32s9h4re","parent_id":"1851ztkf","name":"Set up Vitest testing infrastructure","description":"Configure Vitest with React Testing Library for unit testing.\n\n## Implementation\n1. Create vitest.config.ts with jsdom environment\n2. Set up test utilities and custom render function\n3. Add testing scripts to package.json\n4. Create sample test to verify setup\n\n## Files to Create\n- vitest.config.ts\n- src/test/setup.ts (jest-dom matchers, cleanup)\n- src/test/utils.tsx (custom render with providers)\n- src/test/sample.test.ts (verify setup works)\n\n## Configuration\n- jsdom environment for DOM testing\n- Path aliases matching tsconfig\n- Coverage configuration (optional for now)\n\n## Acceptance Criteria\n- `npm test` runs Vitest\n- `npm run test:watch` for development\n- Sample test passes\n- React components can be tested with RTL\n- Tauri mocks available for commands","priority":1,"completed":true,"result":"Enhanced Vitest testing infrastructure with Tauri mocks.\n\n## Files Modified\n- src/test/setup.ts: Added proper cleanup, localStorage mock improvements, and Tauri API mocks (invoke, listen, emit, open)\n- src/test/sample.test.tsx: Updated to use exported tauriMocks\n\n## Verification\n- All 14 tests passing (4 sample tests + 10 useTheme tests)\n- npm test runs vitest single run\n- npm run test:watch runs vitest in watch mode\n- npm run test:coverage configured for coverage reports\n- Tauri mocks verified working - invoke mock called correctly in App greeting test\n\n## Infrastructure Ready\n- vitest.config.ts with jsdom, globals, coverage config\n- src/test/setup.ts with jest-dom matchers, cleanup, localStorage mock, Tauri mocks\n- src/test/utils.tsx with custom render and exported testing utilities\n- src/test/sample.test.tsx demonstrating RTL + Tauri mock usage","metadata":{"commit":{"sha":"42455aa","message":"Enhance Vitest testing infrastructure with Tauri mocks","branch":"main","timestamp":"2026-02-08T17:48:25.911Z"}},"created_at":"2026-02-08T17:33:46.673Z","updated_at":"2026-02-08T17:48:25.913Z","started_at":"2026-02-08T17:48:25.913Z","completed_at":"2026-02-08T17:48:25.913Z","blockedBy":["ipb6e2xv"],"blocks":[],"children":[]}
{"id":"4ksx48st","parent_id":null,"name":"Core Features","description":"Wire up the main code review functionality.\n\n## Goal\nEnable the core workflow: add repos, browse commits, view changed files, review diffs.\n\n## Features\n1. **Add Repo** - Native folder picker → validate → add to store\n2. **Repo Selector** - Dropdown in toolbar showing current repo\n3. **Commit List** - Paginated list with summary, author, timestamp\n4. **File List** - Changed files for selected commit with +/- indicators\n5. **Diff View** - Side-by-side/unified toggle, word-level highlighting\n\n## Backend Commands to Add\n- get_commit_files(repo_path, commit_id) → Vec<ChangedFile>\n- get_file_diff(repo_path, commit_id, file_path) → FileDiff\n- get_current_branch(repo_path) → String\n- validate_repo(path) → Result<RepoInfo, Error>\n\n## Out of Scope (Backlog)\n- Branch switching\n- Branch comparison\n- Commit message expansion on hover\n\n## Acceptance Criteria\n- Can add a local git repo via folder picker\n- Can switch between added repos\n- Commits load with pagination (infinite scroll)\n- Selecting a commit shows changed files\n- Selecting a file shows diff with word-level highlighting\n- Can toggle between side-by-side and unified diff views","priority":1,"completed":true,"result":"All three vertical slices complete: V1 (commits list), V2 (changed files), V3 (diff view). Full end-to-end flow working.","metadata":null,"created_at":"2026-02-08T19:11:40.774Z","updated_at":"2026-02-08T22:03:48.601Z","started_at":"2026-02-08T22:03:48.599Z","completed_at":"2026-02-08T22:03:48.601Z","blockedBy":[],"blocks":[],"children":["a8wp6p9f","731j9er9","653ymyiu","h3noo5gu","khyw5kdr"]}
{"id":"653ymyiu","parent_id":"4ksx48st","name":"V1: Add repo and see commits","description":"End-to-end slice: User adds a repo and sees real commits.\n\n## Current State\n- AddRepoButton works (folder picker → validate → add to store → select)\n- Sidebar shows mock commits, not real data\n- list_commits backend command exists but isn't called\n\n## What Needs to Happen\n1. When selectedRepoId changes, fetch commits using list_commits\n2. Replace mock data in Sidebar with real commit data\n3. Add loading state while fetching\n4. Add empty state when no repo selected\n5. Store commits in component state (or Zustand if needed later)\n\n## Files to Modify\n- src/components/Layout/Sidebar.tsx - replace mock with real data\n- May need src/hooks/useCommits.ts - data fetching hook\n\n## Data Flow\n```\nUser clicks 'Add Repo' \n  → folder picker → validate_repo → addRepo() → selectRepo()\n  → selectedRepoId changes\n  → Sidebar detects change, calls list_commits(repoPath, 50)\n  → Real commits render\n```\n\n## Acceptance Criteria\n- Add a real git repo via folder picker\n- See actual commits from that repo in sidebar\n- Commits show: message (first line), short SHA, relative time\n- Loading spinner while fetching\n- 'No repository selected' when none selected\n- Works end-to-end in the app","priority":1,"completed":true,"result":"Wired Sidebar to fetch real commits via list_commits command. Added Commit type, loading/error/empty states, date-fns for relative time, and 7 unit tests.","metadata":null,"created_at":"2026-02-08T21:22:38.237Z","updated_at":"2026-02-08T21:44:31.565Z","started_at":"2026-02-08T21:44:31.564Z","completed_at":"2026-02-08T21:44:31.565Z","blockedBy":[],"blocks":["h3noo5gu"],"children":[]}
{"id":"731j9er9","parent_id":"4ksx48st","name":"Add repo flow with native folder picker","description":"Implement the add repository flow using Tauri's native dialog.\n\n## Implementation\n1. Add tauri-plugin-dialog for native folder picker\n2. Create AddRepoButton component in toolbar\n3. On click: open folder picker → validate with backend → add to Zustand store\n4. Show error toast if not a valid git repo\n\n## Dependencies\n- @tauri-apps/plugin-dialog (npm)\n- tauri-plugin-dialog (Cargo)\n\n## Files to Create/Modify\n- src/components/Toolbar/AddRepoButton.tsx\n- src-tauri/Cargo.toml (add plugin)\n- src-tauri/src/lib.rs (register plugin)\n- src-tauri/capabilities/default.json (add dialog permission)\n\n## Flow\n```\nClick 'Add Repo' → Native folder picker opens → User selects folder\n→ Call validate_repo(path) → If valid: addRepo(repoInfo) to store\n→ If invalid: show error toast\n```\n\n## Acceptance Criteria\n- Native macOS folder picker opens\n- Valid repos are added to store and appear in selector\n- Invalid folders show clear error message\n- Unit test for AddRepoButton component","priority":1,"completed":true,"result":"Implemented add repo flow with native folder picker:\n\n## Components Added\n\n**AddRepoButton** (src/components/Toolbar/AddRepoButton.tsx)\n- Opens native macOS folder picker via @tauri-apps/plugin-dialog\n- Validates selected folder with validate_repo backend command\n- Adds valid repos to Zustand store and auto-selects them\n- Supports onError callback for error handling (e.g., toast notifications)\n- Shows loading state (\"Adding...\") while processing\n- Handles edge cases: user cancel, array responses, duplicates\n\n## Backend Integration\n- Added tauri-plugin-dialog to Cargo.toml\n- Registered plugin in lib.rs\n- Added dialog:default permission to capabilities\n\n## Testing\n- 12 unit tests covering all flows\n- All 56 frontend tests pass\n- Rust backend builds successfully\n\n## Files Modified/Created\n- src-tauri/Cargo.toml, lib.rs, capabilities/default.json\n- src/components/Toolbar/AddRepoButton.tsx, index.ts\n- src/components/Toolbar/AddRepoButton.test.tsx\n- src/test/setup.tsx (added dialog mock)\n- bun.lockb, package.json","metadata":{"commit":{"sha":"cd9f1af","message":"Add repo flow with native folder picker","branch":"main","timestamp":"2026-02-08T20:24:03.935Z"}},"created_at":"2026-02-08T19:12:01.690Z","updated_at":"2026-02-08T20:24:03.937Z","started_at":"2026-02-08T20:24:03.936Z","completed_at":"2026-02-08T20:24:03.937Z","blockedBy":["a8wp6p9f"],"blocks":[],"children":[]}
{"id":"8wgwdi46","parent_id":null,"name":"Repository picker: basic switching","description":"## Problem\nUsers can add repos but can't switch between them. The toolbar shows the current repo name but it's not interactive.\n\n## Solution\nTurn the repo name display into a clickable picker that shows all added repos.\n\n## Implementation\n\n### UI\n1. Make the repo name in toolbar clickable\n2. On click, show a popup/dropdown with list of all repos\n3. Each repo shows: name, path (truncated), maybe last accessed\n4. Click repo to switch to it\n5. Close popup on selection or click outside\n\n### Components\n- RepoPickerButton - the trigger showing current repo name + dropdown icon\n- RepoPickerPopup - the popup with repo list\n- Use Radix UI Popover or similar for popup behavior\n\n### Store\n- Already have `repos` and `selectRepo` - just need to wire up UI\n\n## Acceptance Criteria\n- Clicking repo name opens picker popup\n- All added repos shown in list\n- Clicking a repo switches to it and closes popup\n- Current repo highlighted in list\n- Popup closes on outside click or Escape","priority":1,"completed":true,"result":"Implemented repository picker with Radix DropdownMenu.\n\n**Components created:**\n- RepoPickerButton.tsx - Dropdown trigger + menu with all repos\n- RepoPickerButton.test.tsx - 9 tests covering all behaviors\n\n**Changes:**\n- Store: addRepo now auto-selects the new repo\n- Toolbar: Uses RepoPickerButton, hidden when no repos\n- AddRepoButton: Simplified (removed redundant selectRepo)\n\n**Features:**\n- Click repo name → dropdown with all repos\n- Checkmark on current selection\n- Click to switch, dropdown closes\n- Empty state: only Add Repo button shown\n\n**Verification:**\n- 127 tests passing (11 new)\n- TypeScript clean\n- Manual testing: add repos, switch between them, verify checkmark","metadata":{"commit":{"sha":"a4c6f7a","message":"Add repository picker for switching between repos","branch":"main","timestamp":"2026-02-09T01:20:00.592Z"}},"created_at":"2026-02-08T22:35:51.732Z","updated_at":"2026-02-09T01:20:00.594Z","started_at":"2026-02-09T01:20:00.594Z","completed_at":"2026-02-09T01:20:00.594Z","blockedBy":[],"blocks":["2fijqgs9","q1i5oemp"],"children":[]}
{"id":"9ytgzrqz","parent_id":null,"name":"Changes view: auto-update on file changes","description":"## Problem\nChanges view shows a static snapshot. When files change on disk, user must manually refresh.\n\n## Solution\nAutomatically refresh the changes view when repository files change.\n\n## Options\n\n### 1. Polling (simpler, safer)\n- Poll `get_working_changes` every N seconds (e.g., 2-3s) when Changes view is active\n- Pros: Simple, works everywhere, no file descriptor limits\n- Cons: Slight delay, unnecessary work if nothing changed\n\n### 2. File watching (more responsive)\n- Use `notify` crate in Rust to watch repo directory\n- Emit Tauri event when changes detected\n- Pros: Instant updates\n- Cons: Can hit file descriptor limits on large repos, more complex\n\n### Recommendation\nStart with polling. Can add file watching later as optimization.\n\n## Implementation\n1. When in Changes view, start polling interval\n2. Compare new file list with current to avoid unnecessary re-renders\n3. Stop polling when switching to History view or different repo\n4. Add loading indicator for refresh (subtle, non-blocking)\n\n## Acceptance Criteria\n- Changes view updates automatically when files modified\n- No excessive re-renders if nothing changed\n- Polling stops when not in Changes view\n- Works with large repos without issues","priority":1,"completed":true,"result":"Implemented polling-based auto-refresh for Changes view:\n- Polls get_working_changes every 2 seconds when in Changes view\n- Automatically stops polling when switching to History view\n- Stops polling when component unmounts or repo changes\n- Added 4 tests for auto-refresh behavior (167 total tests passing)","metadata":{"commit":{"sha":"c262d06","message":"feat: auto-refresh changes view every 2 seconds","branch":"main","timestamp":"2026-02-09T23:18:36.192Z"}},"created_at":"2026-02-08T22:32:58.492Z","updated_at":"2026-02-09T23:18:36.194Z","started_at":"2026-02-09T23:18:36.194Z","completed_at":"2026-02-09T23:18:36.194Z","blockedBy":["1bqhvchx"],"blocks":[],"children":[]}
{"id":"a8wp6p9f","parent_id":"4ksx48st","name":"Add backend commands for commit files and diff","description":"Extend the git module with commands to get changed files and diffs.\n\n## Commands to Add\n\n### get_commit_files\n```rust\n#[derive(Serialize)]\nstruct ChangedFile {\n    path: String,\n    status: FileStatus, // Added, Modified, Deleted, Renamed\n    additions: u32,\n    deletions: u32,\n    old_path: Option<String>, // For renames\n}\n\n#[tauri::command]\nfn get_commit_files(repo_path: String, commit_id: String) -> Result<Vec<ChangedFile>, String>\n```\n\n### get_file_diff\n```rust\n#[derive(Serialize)]\nstruct DiffHunk {\n    old_start: u32,\n    old_lines: u32,\n    new_start: u32,\n    new_lines: u32,\n    lines: Vec<DiffLine>,\n}\n\n#[derive(Serialize)]\nstruct DiffLine {\n    content: String,\n    line_type: LineType, // Context, Addition, Deletion\n    old_line_no: Option<u32>,\n    new_line_no: Option<u32>,\n}\n\n#[derive(Serialize)]\nstruct FileDiff {\n    old_path: Option<String>,\n    new_path: String,\n    hunks: Vec<DiffHunk>,\n    is_binary: bool,\n}\n\n#[tauri::command]\nfn get_file_diff(repo_path: String, commit_id: String, file_path: String) -> Result<FileDiff, String>\n```\n\n### get_current_branch\n```rust\n#[tauri::command]\nfn get_current_branch(repo_path: String) -> Result<String, String>\n```\n\n### validate_repo\n```rust\n#[derive(Serialize)]\nstruct RepoInfo {\n    path: String,\n    name: String, // Directory name\n    branch: String,\n}\n\n#[tauri::command]\nfn validate_repo(path: String) -> Result<RepoInfo, String>\n```\n\n## Files to Modify\n- src-tauri/src/git.rs (add new functions)\n- src-tauri/src/lib.rs (register commands)\n\n## Acceptance Criteria\n- All commands work correctly with test repos\n- Proper error handling for edge cases (binary files, empty commits, etc.)\n- Rust unit tests for new functions","priority":1,"completed":true,"result":"Added 4 new backend commands to git.rs with proper error handling and tests:\n\n## Commands Added\n\n1. **get_commit_files(repo_path, commit_id)** → Vec<ChangedFile>\n   - Returns files with: path, status (Added/Modified/Deleted/Renamed/Copied), additions, deletions, old_path\n   - Handles initial commits (no parent) correctly\n\n2. **get_file_diff(repo_path, commit_id, file_path)** → FileDiff\n   - Returns: old_path, new_path, hunks (with old/new_start/lines), is_binary\n   - Each hunk has lines with: content, line_type (Context/Addition/Deletion), old/new_line_no\n   - Properly handles binary files (returns empty hunks with is_binary=true)\n\n3. **get_current_branch(repo_path)** → String\n   - Returns branch name or SHA when in detached HEAD state\n\n4. **validate_repo(path)** → RepoInfo\n   - Returns: path (normalized), name (directory name), branch\n   - Proper error for non-repos and bare repos\n\n## Testing\n- 18 new unit tests covering normal operations, edge cases, and error handling\n- All 25 tests pass\n\n## Files Modified\n- src-tauri/src/git.rs: Added types, functions, and tests\n- src-tauri/src/lib.rs: Registered new Tauri commands","metadata":{"commit":{"sha":"eae03e8","message":"Add backend commands for commit files and diff","branch":"main","timestamp":"2026-02-08T20:20:23.079Z"}},"created_at":"2026-02-08T19:11:52.270Z","updated_at":"2026-02-08T20:20:23.084Z","started_at":"2026-02-08T20:20:23.083Z","completed_at":"2026-02-08T20:20:23.084Z","blockedBy":[],"blocks":["731j9er9"],"children":[]}
{"id":"bb55xs4r","parent_id":null,"name":"Fullscreen diff view toggle","description":"## Problem\nWhen reviewing a diff, the commit list and file list panels take up space. Users want to focus on just the diff.\n\n## Solution\nAdd a toggle to hide the left panels (commits + files) and show only the diff view in fullscreen.\n\n## Implementation\n1. Add state to store: `isDiffFullscreen: boolean`\n2. Add toolbar button (expand icon) to toggle fullscreen\n3. Add keyboard shortcut (e.g., Cmd+Enter or Cmd+Shift+F)\n4. When fullscreen: hide Panel 1 (commits) and Panel 2 (files), expand Panel 3 (diff) to 100%\n5. Show a floating button or use same shortcut to exit fullscreen\n6. Persist preference in localStorage (optional)\n\n## Acceptance Criteria\n- Toolbar button toggles fullscreen mode\n- Keyboard shortcut works\n- Diff panel expands to full width\n- Easy to exit back to normal view\n- Shortcut shown in button tooltip","priority":1,"completed":false,"result":null,"metadata":null,"created_at":"2026-02-08T22:32:21.646Z","updated_at":"2026-02-08T22:32:21.646Z","started_at":null,"completed_at":null,"blockedBy":[],"blocks":[],"children":[]}
{"id":"c31d8bo5","parent_id":null,"name":"Branch picker: basic switching UI","description":"## Problem\nUsers can see the current branch but can't switch branches.\n\n## Solution\nTurn branch name display into a clickable picker.\n\n## Implementation\n\n### UI\n1. Make branch name in toolbar clickable (similar to repo picker)\n2. On click, fetch and show list of branches\n3. Current branch highlighted\n4. Click branch to switch\n5. Show loading state while switching\n6. Refresh commit list after switch\n\n### Components\n- BranchPickerButton - trigger showing current branch + icon\n- BranchPickerPopup - popup with branch list\n\n### State Flow\n1. Click branch name -> open popup, call `list_branches`\n2. Click different branch -> call `checkout_branch`\n3. On success -> update current branch display, refresh commits\n4. On error (uncommitted changes) -> show error message\n\n## Acceptance Criteria\n- Clicking branch name opens picker\n- All local branches listed\n- Current branch highlighted\n- Clicking branch switches to it\n- Commit list refreshes after switch\n- Error shown if switch fails (e.g., uncommitted changes)","priority":1,"completed":false,"result":null,"metadata":null,"created_at":"2026-02-08T22:36:26.583Z","updated_at":"2026-02-08T22:36:38.991Z","started_at":null,"completed_at":null,"blockedBy":["o7aj57r1"],"blocks":["q457lykx"],"children":[]}
{"id":"cfbyuttv","parent_id":null,"name":"Migrate Zustand persistence to Tauri fs plugin","description":"Replace localStorage with Tauri's app data directory for more robust cross-platform storage.\n\n## Current State\nUsing Zustand persist middleware with localStorage ('code-review-storage' key).\n\n## Why Migrate\n- localStorage can be cleared by browser/webview cleanup\n- Tauri app data directory is the proper location for desktop app data\n- More consistent with native app behavior\n- Survives webview cache clears\n\n## Implementation\n1. Add @tauri-apps/plugin-fs to frontend\n2. Add tauri-plugin-fs to Cargo.toml\n3. Register plugin and add capabilities\n4. Create custom Zustand storage adapter using Tauri fs\n5. Store in app data directory (e.g., ~/.local/share/code-review/store.json on Linux)\n6. Handle migration from localStorage for existing users\n\n## Files to Modify\n- package.json (add @tauri-apps/plugin-fs)\n- src-tauri/Cargo.toml (add tauri-plugin-fs)\n- src-tauri/src/lib.rs (register plugin)\n- src-tauri/capabilities/default.json (add fs permissions)\n- src/store/appStore.ts (custom storage adapter)\n\n## Acceptance Criteria\n- Data persists in Tauri app data directory\n- Existing localStorage data migrated on first run\n- Works on macOS, Linux, Windows\n- Unit tests updated","priority":1,"completed":false,"result":null,"metadata":null,"created_at":"2026-02-08T19:15:05.973Z","updated_at":"2026-02-08T19:15:05.973Z","started_at":null,"completed_at":null,"blockedBy":[],"blocks":[],"children":[]}
{"id":"dowz44t6","parent_id":null,"name":"Multi-commit selection with combined diff","description":"## Problem\nWhen reviewing related commits (e.g., a feature branch), you often want to see the combined diff across multiple commits rather than reviewing each one individually.\n\n## Solution\nAllow selecting a range of commits (like GitHub Desktop) and show their combined diff.\n\n## UI Reference\nGitHub Desktop shows:\n- Shift+click or drag to select commit range\n- Header: \"Showing changes from N commits\"\n- File list shows all files changed across the range\n- Diff shows the combined changes (first commit's parent → last commit)\n\n## Implementation\n1. **Store**: Track `selectedCommitIds: string[]` instead of single ID\n2. **UI**: Enable shift+click / cmd+click for multi-select in commit list\n3. **Backend**: Add Tauri command `get_commit_range_files` and `get_commit_range_diff`\n4. **Rust**: Use git2 to diff between first commit's parent and last commit\n\n## Acceptance Criteria\n- Shift+click selects range between two commits\n- Cmd+click toggles individual commits (optional, could skip)\n- Shows \"Showing changes from N commits\" in header\n- File list and diff reflect combined changes\n- Single click still works for single commit selection","priority":1,"completed":false,"result":null,"metadata":null,"created_at":"2026-02-09T21:31:42.863Z","updated_at":"2026-02-09T21:31:42.863Z","started_at":null,"completed_at":null,"blockedBy":[],"blocks":[],"children":[]}
{"id":"h3noo5gu","parent_id":"4ksx48st","name":"V2: Click commit and see changed files","description":"End-to-end slice: User clicks a commit and sees real changed files.\n\n## Depends On\n- V1 complete (real commits showing in sidebar)\n\n## Current State\n- FileList shows mock data\n- get_commit_files backend command exists but isn't called\n- No selectedCommitId in store\n\n## What Needs to Happen\n1. Add selectedCommitId to Zustand store\n2. Make commits in Sidebar clickable, update selectedCommitId on click\n3. When selectedCommitId changes, fetch files using get_commit_files\n4. Replace mock data in FileList with real file data\n5. Show file status (Added/Modified/Deleted) with appropriate colors\n6. Show +/- line counts\n\n## Files to Modify\n- src/store/appStore.ts - add selectedCommitId + setSelectedCommit\n- src/components/Layout/Sidebar.tsx - make commits clickable\n- src/components/Layout/FileList.tsx - replace mock with real data\n- May need src/hooks/useCommitFiles.ts\n\n## Data Flow\n```\nUser clicks commit in Sidebar\n  → setSelectedCommit(commitId)\n  → FileList detects change, calls get_commit_files(repoPath, commitId)\n  → Real changed files render with status icons\n```\n\n## Acceptance Criteria\n- Clicking a commit highlights it in sidebar\n- Changed files appear in middle panel\n- Files show status: A (green), M (yellow), D (red)\n- Files show +X / -Y line counts\n- Loading state while fetching\n- 'Select a commit' when none selected\n- Works end-to-end in the app","priority":1,"completed":true,"result":"Wired commit selection and file list. Added selectedCommitId to store, made commits clickable in Sidebar, FileList fetches real files via get_commit_files. Shows status (A/M/D), +/- line counts. Added 13 new tests (76 total).","metadata":null,"created_at":"2026-02-08T21:22:47.868Z","updated_at":"2026-02-08T21:52:48.313Z","started_at":"2026-02-08T21:52:48.312Z","completed_at":"2026-02-08T21:52:48.313Z","blockedBy":["653ymyiu"],"blocks":["khyw5kdr"],"children":[]}
{"id":"i6bpcms8","parent_id":null,"name":"Fix file list diff stats overlapping with filenames","description":"## Problem\nIn the file list, when filenames are truncated, the diff stats (+X -Y) overlap with the filename text instead of being properly separated.\n\n## Screenshot\nShows 'RepoPickerButton.test.tsx' with stats running into the truncated name.\n\n## Solution\nEnsure proper spacing/layout between filename (which should truncate with ellipsis) and the diff stats (which should never truncate). Likely need:\n- `flex-shrink-0` on the stats\n- `truncate` or `overflow-hidden text-ellipsis` on the filename\n- Proper gap between elements","priority":1,"completed":false,"result":null,"metadata":null,"created_at":"2026-02-09T09:49:30.561Z","updated_at":"2026-02-09T09:49:30.561Z","started_at":null,"completed_at":null,"blockedBy":[],"blocks":[],"children":[]}
{"id":"i9mzuail","parent_id":"1851ztkf","name":"Add git2 backend with list commits command","description":"Set up git2 crate and create initial Tauri command for listing commits.\n\n## Implementation\n1. Add git2 crate to Cargo.toml\n2. Create git module for repository operations\n3. Define commit data structures (serializable)\n4. Implement list_commits command\n5. Register command in Tauri\n\n## Data Structures\n```rust\n#[derive(Serialize)]\nstruct Commit {\n    id: String,      // SHA\n    message: String, // First line\n    author: String,\n    email: String,\n    timestamp: i64,  // Unix timestamp\n}\n```\n\n## Files to Create/Modify\n- src-tauri/Cargo.toml (add git2)\n- src-tauri/src/git.rs (git operations module)\n- src-tauri/src/lib.rs (register commands)\n\n## Tauri Command\n```rust\n#[tauri::command]\nfn list_commits(repo_path: String, limit: Option<usize>) -> Result<Vec<Commit>, String>\n```\n\n## Acceptance Criteria\n- git2 compiles without issues\n- list_commits returns commits from a real repo\n- Proper error handling (repo not found, not a git repo)\n- Rust unit tests for git module\n- Can be called from frontend via invoke()","priority":1,"completed":true,"result":"Implemented git2 backend with list_commits Tauri command. Added git module with Commit struct, vendored-libgit2 for cross-platform builds, and 7 unit tests covering all acceptance criteria. Commit: c7311af","metadata":null,"created_at":"2026-02-08T17:33:55.099Z","updated_at":"2026-02-08T17:52:09.830Z","started_at":"2026-02-08T17:52:09.829Z","completed_at":"2026-02-08T17:52:09.830Z","blockedBy":[],"blocks":[],"children":[]}
{"id":"ihdsm9qr","parent_id":null,"name":"Changes view: split by staged/unstaged","description":"## Problem\nChanges view shows all modified files in a flat list. Users need to distinguish between staged and unstaged changes like in GitHub Desktop.\n\n## Solution\nSplit the file list into two sections: 'Staged Changes' and 'Unstaged Changes'.\n\n## Implementation\n\n### Backend\nUpdate `get_working_changes` to include staging status:\n```rust\nstruct WorkingFile {\n    path: String,\n    status: FileStatus,\n    staged: bool,  // or separate staged_status / unstaged_status\n}\n```\n\ngit2's `StatusEntry` provides both index (staged) and workdir (unstaged) status.\n\n### Frontend\n1. Split file list into two sections with subtle headers\n2. 'Staged Changes' section at top\n3. 'Unstaged Changes' section below\n4. Each section collapsible (optional)\n5. Show count in section headers: 'Staged Changes (3)'\n6. Empty sections can be hidden or show 'No staged/unstaged changes'\n\n### Diff Behavior\n- Clicking staged file: show diff of staged vs HEAD\n- Clicking unstaged file: show diff of working copy vs staged (or HEAD if not staged)\n\n## Acceptance Criteria\n- Files grouped by staged/unstaged\n- Section headers with counts\n- Correct diff shown for each type\n- Handles files that are both staged and have unstaged changes","priority":1,"completed":false,"result":null,"metadata":null,"created_at":"2026-02-08T22:33:07.910Z","updated_at":"2026-02-08T22:33:30.051Z","started_at":null,"completed_at":null,"blockedBy":["1bqhvchx"],"blocks":[],"children":[]}
{"id":"ipb6e2xv","parent_id":"1851ztkf","name":"Install frontend dependencies","description":"Install and configure all frontend dependencies.\n\n## Dependencies to Add\n- zustand (state management)\n- tailwindcss + postcss + autoprefixer (styling)\n- @radix-ui/react-dropdown-menu, @radix-ui/react-dialog, @radix-ui/react-scroll-area (UI primitives)\n- react-resizable-panels (3-panel layout)\n- react-diff-viewer-continued (diff display)\n- clsx + tailwind-merge (className utilities)\n\n## Dev Dependencies\n- vitest + @testing-library/react + @testing-library/jest-dom + jsdom (testing)\n\n## Acceptance Criteria\n- All packages install without conflicts\n- package.json updated with correct versions\n- No TypeScript errors from new packages","priority":1,"completed":true,"result":"Installed all frontend dependencies:\n- Production: zustand, tailwindcss, postcss, autoprefixer, @radix-ui/react-dropdown-menu, @radix-ui/react-dialog, @radix-ui/react-scroll-area, react-resizable-panels, react-diff-viewer-continued, clsx, tailwind-merge\n- Dev: vitest, @testing-library/react, @testing-library/jest-dom, jsdom\nAll packages installed without conflicts. TypeScript compiles with no errors. Changes committed.","metadata":null,"created_at":"2026-02-08T17:33:23.500Z","updated_at":"2026-02-08T17:42:05.449Z","started_at":"2026-02-08T17:42:05.447Z","completed_at":"2026-02-08T17:42:05.449Z","blockedBy":[],"blocks":["sxfhtrlr","32s9h4re","mkjgy2fg"],"children":[]}
{"id":"khyw5kdr","parent_id":"4ksx48st","name":"V3: Click file and see diff","description":"End-to-end slice: User clicks a file and sees the real diff.\n\n## Depends On\n- V2 complete (real files showing in file list)\n\n## Current State\n- DiffView shows mock diff data\n- get_file_diff backend command exists but isn't called\n- No selectedFilePath in store\n- Split/Unified toggle exists but doesn't work\n\n## What Needs to Happen\n1. Add selectedFilePath to Zustand store\n2. Make files in FileList clickable, update selectedFilePath on click\n3. When selectedFilePath changes, fetch diff using get_file_diff\n4. Replace mock data in DiffView with real diff\n5. Wire up Split/Unified toggle to actually switch views\n6. Persist view preference to localStorage\n\n## Files to Modify\n- src/store/appStore.ts - add selectedFilePath + setSelectedFile\n- src/components/Layout/FileList.tsx - make files clickable\n- src/components/Layout/DiffView.tsx - replace mock with real diff, wire toggle\n\n## Data Flow\n```\nUser clicks file in FileList\n  → setSelectedFile(filePath)\n  → DiffView detects change, calls get_file_diff(repoPath, commitId, filePath)\n  → Real diff renders with syntax highlighting\n```\n\n## Acceptance Criteria\n- Clicking a file highlights it in file list\n- Diff appears in right panel\n- Side-by-side view works (default)\n- Unified view works (toggle)\n- View preference persists\n- Line numbers shown\n- Additions green, deletions red\n- Loading state while fetching\n- 'Select a file' when none selected\n- Binary files show 'Binary file' message\n- Works end-to-end in the app","priority":1,"completed":true,"result":"Wired file selection and diff view. Added selectedFilePath to store, made files clickable in FileList, DiffView fetches real diffs via get_file_diff. Split/Unified toggle works with localStorage persistence. Shows line numbers, additions (green), deletions (red), binary file message. Added 14 new tests (90 total).","metadata":null,"created_at":"2026-02-08T21:22:56.254Z","updated_at":"2026-02-08T22:03:42.232Z","started_at":"2026-02-08T22:03:42.230Z","completed_at":"2026-02-08T22:03:42.232Z","blockedBy":["h3noo5gu"],"blocks":[],"children":[]}
{"id":"mkjgy2fg","parent_id":"1851ztkf","name":"Set up repo persistence with Zustand","description":"Create Zustand store for app state and persist repo list.\n\n## Implementation\n1. Create Zustand store for application state\n2. Configure persistence to Tauri app data directory\n3. Store list of added repositories\n\n## State Shape\n```typescript\ninterface AppState {\n  repos: Repository[];\n  selectedRepoId: string | null;\n  addRepo: (path: string) => void;\n  removeRepo: (id: string) => void;\n  selectRepo: (id: string) => void;\n}\n\ninterface Repository {\n  id: string;\n  path: string;\n  name: string;\n}\n```\n\n## Files to Create\n- src/store/appStore.ts\n- src/store/index.ts\n- src/types/repository.ts\n\n## Persistence\nUse Zustand persist middleware with custom storage adapter for Tauri's app data directory (via @tauri-apps/api/path and @tauri-apps/plugin-fs)\n\n## Acceptance Criteria\n- Store works in React components\n- Repos persist across app restart\n- Unit tests for store actions","priority":1,"completed":true,"result":"Created Zustand store for repo persistence with localStorage.\n\n## Files Created\n- src/types/repository.ts: Repository interface with id, path, name, addedAt\n- src/store/appStore.ts: Zustand store with persist middleware\n- src/store/index.ts: Re-exports for clean imports\n- src/store/appStore.test.ts: 18 unit tests for store actions\n\n## Store Features\n- addRepo(path): Add repository, auto-extracts name from path, prevents duplicates\n- removeRepo(id): Remove by ID, clears selection if removed was selected\n- selectRepo(id): Select a repo, validates existence\n- clearRepos(): Clear all repos and selection\n\n## Selector Hooks\n- useRepos(): Get repos array\n- useSelectedRepoId(): Get selected ID\n- useSelectedRepo(): Get selected repo object\n\n## Persistence\n- Uses Zustand persist middleware with localStorage\n- Storage key: 'code-review-storage'\n- Persists repos list and selection across app restarts\n\n## Verification\n- 18 unit tests passing covering all store actions\n- Path extraction works for Unix, Windows, and trailing slashes\n- Duplicate prevention verified\n- Selection behavior verified","metadata":{"commit":{"sha":"60fb36b","message":"Create 3-panel resizable layout shell","branch":"main","timestamp":"2026-02-08T17:55:25.273Z"}},"created_at":"2026-02-08T17:34:03.361Z","updated_at":"2026-02-08T17:55:25.274Z","started_at":"2026-02-08T17:55:25.274Z","completed_at":"2026-02-08T17:55:25.274Z","blockedBy":["ipb6e2xv"],"blocks":[],"children":[]}
{"id":"o7aj57r1","parent_id":null,"name":"Branch picker: list branches backend","description":"## Problem\nNeed backend support to list all branches and switch between them.\n\n## Solution\nAdd Rust commands for listing branches and checking out a branch.\n\n## Implementation\n\n### list_branches(repo_path) -> Vec<Branch>\n```rust\nstruct Branch {\n    name: String,\n    is_current: bool,\n    is_remote: bool,  // local vs origin/xxx\n    commit_id: String,  // tip commit SHA (optional, for display)\n}\n```\n\nUse git2's `Repository::branches()` to enumerate branches.\n\n### checkout_branch(repo_path, branch_name) -> Result<(), String>\nUse git2 to checkout the branch:\n1. Find the branch reference\n2. Set HEAD to point to it\n3. Checkout the tree (updates working directory)\n\nNote: This modifies the working directory! Should warn if there are uncommitted changes.\n\n## Acceptance Criteria\n- `list_branches` returns all local branches (remotes optional)\n- Current branch marked in response\n- `checkout_branch` switches HEAD and working directory\n- Error returned if uncommitted changes would be overwritten","priority":1,"completed":false,"result":null,"metadata":null,"created_at":"2026-02-08T22:36:19.390Z","updated_at":"2026-02-08T22:36:19.390Z","started_at":null,"completed_at":null,"blockedBy":[],"blocks":["c31d8bo5"],"children":[]}
{"id":"q1i5oemp","parent_id":null,"name":"Repository picker: remove repos","description":"## Problem\nUsers can add repos but can't remove them from the list.\n\n## Solution\nAdd ability to remove repos from the picker.\n\n## Implementation\n\n### Option A: Inline delete\n- Show a small X or trash icon on hover for each repo in picker\n- Click to remove (with confirmation or undo toast)\n\n### Option B: Edit mode\n- Add 'Manage' or 'Edit' button in picker footer\n- Toggles edit mode showing delete buttons\n- Or opens separate management modal\n\n### Recommendation\nStart with Option A (inline delete on hover) - simpler, more discoverable.\n\n### Store\nAlready have `removeRepo(id)` action - just need UI.\n\n## Edge Cases\n- Can't remove currently selected repo (or auto-switch to another)\n- Removing last repo clears selection\n- Confirmation to prevent accidents (or undo toast)\n\n## Acceptance Criteria\n- Can remove repos from the picker\n- Accidental deletion prevented (confirm or undo)\n- Removing selected repo handled gracefully\n- Removing last repo shows empty state","priority":1,"completed":true,"result":"Implemented remove repos feature:\n- Trash icon appears on hover in repo picker\n- Confirmation dialog before removal\n- Auto-selects first remaining repo when removing selected\n- Clears selection when removing last repo\n- 8 new tests added (134 total)","metadata":{"commit":{"sha":"4e09cf8","message":"feat: add remove repos functionality with confirmation dialog","branch":"main","timestamp":"2026-02-09T09:36:02.304Z"}},"created_at":"2026-02-08T22:36:09.660Z","updated_at":"2026-02-09T09:36:02.306Z","started_at":"2026-02-09T09:36:02.305Z","completed_at":"2026-02-09T09:36:02.306Z","blockedBy":["8wgwdi46"],"blocks":[],"children":[]}
{"id":"q457lykx","parent_id":null,"name":"Branch picker: fuzzy search","description":"## Problem\nRepos can have many branches. Scrolling through the list is slow.\n\n## Solution\nAdd search input to branch picker with fuzzy matching.\n\n## Implementation\n1. Add text input at top of branch picker popup\n2. Auto-focus input when popup opens\n3. Filter branches as user types\n4. Fuzzy match on branch name\n5. Keyboard navigation: arrows + Enter\n\n### Shared Component\nConsider extracting a shared `SearchablePicker` component used by both repo and branch pickers:\n- Text input with search\n- Filterable list\n- Keyboard navigation\n- Selection callback\n\n## Acceptance Criteria\n- Search input filters branch list\n- Fuzzy matching works (e.g., 'feat' matches 'feature/login')\n- Keyboard navigation (arrows + Enter)\n- Escape clears or closes","priority":1,"completed":false,"result":null,"metadata":null,"created_at":"2026-02-08T22:36:33.184Z","updated_at":"2026-02-08T22:36:39.223Z","started_at":null,"completed_at":null,"blockedBy":["c31d8bo5"],"blocks":[],"children":[]}
{"id":"qgu73img","parent_id":null,"name":"Auto-select first file when commit is selected","description":"## Problem\nWhen selecting a commit, the user has to manually click a file to see its diff. This adds friction.\n\n## Solution\nWhen a commit is selected (either by click or keyboard), automatically select the first file in the changed files list and display its diff.\n\n## Implementation\n1. In the store or component that handles commit selection, after fetching files, auto-select the first one\n2. Edge case: if commit has no files, clear file selection\n3. Edge case: if already viewing a file from same commit, don't reset selection\n\n## Acceptance Criteria\n- Clicking a commit shows the first file's diff immediately\n- Works with keyboard navigation too (once implemented)\n- Empty commits show appropriate message","priority":1,"completed":true,"result":"Implemented auto-select first file when commit selected. Refactored FileList into useCommitFiles hook and FileListContent component to reduce complexity. Added 2 tests.","metadata":{"commit":{"sha":"eec522a","message":"Auto-select first file when commit is selected","branch":"main","timestamp":"2026-02-09T21:05:23.715Z"}},"created_at":"2026-02-08T22:32:05.670Z","updated_at":"2026-02-09T21:05:23.717Z","started_at":"2026-02-09T21:05:23.717Z","completed_at":"2026-02-09T21:05:23.717Z","blockedBy":[],"blocks":[],"children":[]}
{"id":"qmopqo0z","parent_id":null,"name":"Theme toggle: light/dark/system","description":"## Problem\nUsers can't change the app theme. Need to support light, dark, and system preference modes.\n\n## Solution\nAdd a theme toggle button in the toolbar that cycles through modes.\n\n## Current State\nThere's already a `useTheme` hook - check if it supports all three modes or needs updates.\n\n## Implementation\n\n### Theme Modes\n1. **Light** - always light theme\n2. **Dark** - always dark theme  \n3. **System** - follows OS preference (prefers-color-scheme)\n\n### UI\n1. Add theme toggle button in toolbar\n2. Icon indicates current mode (sun/moon/auto icon)\n3. Click cycles: light → dark → system → light\n4. Or use dropdown/popover to pick mode directly\n5. Tooltip shows current mode and shortcut\n\n### Keyboard Shortcut\nAdd shortcut to toggle theme (e.g., Cmd+Shift+T)\n\n### Persistence\nStore preference in localStorage (likely already done in useTheme)\n\n### System Mode Behavior\n- Listen to `prefers-color-scheme` media query\n- Update in real-time if OS preference changes\n\n## Acceptance Criteria\n- Button in toolbar to change theme\n- Three modes: light, dark, system\n- System mode follows OS and updates live\n- Preference persisted across sessions\n- Keyboard shortcut works","priority":1,"completed":false,"result":null,"metadata":null,"created_at":"2026-02-08T22:40:22.594Z","updated_at":"2026-02-08T22:40:22.594Z","started_at":null,"completed_at":null,"blockedBy":[],"blocks":[],"children":[]}
{"id":"rnuxwitl","parent_id":null,"name":"Backend: return file contents instead of pre-computed diff","description":"Change backend to return old/new file contents so react-diff-viewer-continued can compute diffs with proper word-level highlighting.\n\n## Problem\nCurrent `get_file_diff` returns pre-computed diff hunks. We reconstruct old/new strings from these, but this loses context and the library can't do proper word-level diffing.\n\n## Solution\nAdd new command `get_file_contents(repoPath, commitId, filePath)` that returns:\n```rust\nstruct FileContents {\n    old_content: Option<String>,  // None if file was added\n    new_content: Option<String>,  // None if file was deleted  \n    is_binary: bool,\n}\n```\n\n## Changes\n1. Add `get_file_contents` function in `src-tauri/src/git.rs`\n2. Add Tauri command in `src-tauri/src/lib.rs`\n3. Update `DiffView.tsx` to call new command\n4. Add TypeScript types for `FileContents`\n5. Can remove `get_file_diff` and related types if no longer needed\n\n## Reference\nSee GitHub Desktop screenshot for expected word-level highlighting behavior.","priority":1,"completed":true,"result":"Implemented get_file_contents backend command and updated frontend to use it.\n\n## Changes\n- Added FileContents struct: old_content (Option<String>), new_content (Option<String>), is_binary (bool)\n- Implemented get_file_contents in git.rs that reads blob content from commit tree and parent tree\n- Registered Tauri command in lib.rs\n- Updated DiffView.tsx to call get_file_contents instead of get_file_diff\n- Added TypeScript FileContents type in diff.ts\n- Added 4 backend tests for added/modified/deleted files and file-not-in-commit error\n- Updated all 12 DiffView tests to use new mock shape\n\n## Verification\n- 29 Rust tests pass (cargo test)\n- 93 frontend tests pass (bun run test)\n- Dev server running, ready for manual testing","metadata":{"commit":{"sha":"85bb458","message":"Add get_file_contents backend for proper diff library support","branch":"main","timestamp":"2026-02-08T22:21:18.996Z"}},"created_at":"2026-02-08T22:14:34.923Z","updated_at":"2026-02-08T22:21:18.998Z","started_at":"2026-02-08T22:21:18.997Z","completed_at":"2026-02-08T22:21:18.998Z","blockedBy":[],"blocks":[],"children":[]}
{"id":"s26gk1l8","parent_id":"1851ztkf","name":"Create 3-panel layout shell","description":"Build the main application layout with resizable panels.\n\n## Layout Structure\n```\n┌─────────────────────────────────────────────────────────┐\n│ Toolbar (repo selector, branch, actions)                │\n├────────────┬────────────────┬───────────────────────────┤\n│ Sidebar    │ File List      │ Diff View                 │\n│ (commits)  │ (changed files)│ (side-by-side/unified)    │\n│            │                │                           │\n│ resizable→ │ ←resizable→    │                           │\n└────────────┴────────────────┴───────────────────────────┘\n```\n\n## Implementation\n1. Create layout components structure\n2. Use react-resizable-panels for the 3 columns\n3. Add toolbar as fixed header\n4. Persist panel sizes to localStorage\n\n## Files to Create\n- src/components/Layout/AppLayout.tsx (main container)\n- src/components/Layout/Toolbar.tsx (placeholder)\n- src/components/Layout/Sidebar.tsx (placeholder for commit list)\n- src/components/Layout/FileList.tsx (placeholder)\n- src/components/Layout/DiffView.tsx (placeholder)\n- src/components/Layout/index.ts (exports)\n\n## Acceptance Criteria\n- 3 resizable panels render\n- Panels have min/max sizes\n- Panel sizes persist across refresh\n- Responsive collapse behavior for narrow windows\n- Unit test for AppLayout rendering","priority":1,"completed":true,"result":"Created 3-panel resizable layout with react-resizable-panels v4:\n\nComponents created:\n- AppLayout: Main container with Group/Panel/Separator\n- Toolbar: Header with repo selector, branch, refresh buttons\n- Sidebar: Commits panel (20-35% width, collapsible)\n- FileList: Changed files panel (15-40% width, collapsible)\n- DiffView: Diff display panel (min 30% width)\n\nFeatures:\n- Panel sizes persist to localStorage via useDefaultLayout hook\n- Panels have min/max size constraints\n- Sidebar and FileList are collapsible\n- Responsive resize handles with hover states\n- GitHub Desktop-inspired styling with theme variables\n\nTests: 10 passing for AppLayout component\nTypeScript: Compiles without errors","metadata":null,"created_at":"2026-02-08T17:33:39.664Z","updated_at":"2026-02-08T17:54:58.262Z","started_at":"2026-02-08T17:54:58.261Z","completed_at":"2026-02-08T17:54:58.262Z","blockedBy":["sxfhtrlr"],"blocks":[],"children":[]}
{"id":"sxfhtrlr","parent_id":"1851ztkf","name":"Set up Tailwind CSS with theming","description":"Configure Tailwind CSS with light/dark/system theme support.\n\n## Implementation\n1. Initialize Tailwind config (tailwind.config.js)\n2. Add Tailwind directives to main CSS\n3. Configure dark mode with 'class' strategy\n4. Create CSS variables for theme colors (similar to GitHub Desktop palette)\n5. Add theme toggle logic using system preference detection\n\n## Files to Create/Modify\n- tailwind.config.js\n- src/index.css (replace App.css)\n- src/hooks/useTheme.ts (theme management hook)\n- src/components/ThemeProvider.tsx (optional, or use Zustand)\n\n## Acceptance Criteria\n- Tailwind classes work in components\n- Theme persists to localStorage\n- System preference respected on first load\n- Manual override works (light/dark/system)\n- Test for useTheme hook","priority":1,"completed":true,"result":"Tailwind CSS v4 configured with theming support:\n- Installed @tailwindcss/vite plugin\n- Created src/index.css with GitHub Desktop-inspired color palette\n- CSS variables for light/dark modes with 'class' strategy\n- Created useTheme hook with localStorage persistence & system preference detection\n- Added cn() utility (clsx + tailwind-merge)\n- Set up Vitest with React Testing Library\n- All 10 useTheme tests passing\n- TypeScript compiles without errors","metadata":null,"created_at":"2026-02-08T17:33:30.194Z","updated_at":"2026-02-08T17:46:54.617Z","started_at":"2026-02-08T17:46:54.616Z","completed_at":"2026-02-08T17:46:54.617Z","blockedBy":["ipb6e2xv"],"blocks":["s26gk1l8"],"children":[]}
{"id":"uuat9l2p","parent_id":null,"name":"Force unified view for new/deleted files","description":"## Problem\nWhen viewing a newly added or deleted file in split mode, half the screen is empty. This wastes space and makes the content harder to read.\n\n## Solution\nAutomatically use unified view for files where one side is empty, and disable the split/unified toggle.\n\n## Behavior\n- **Added file** (old_content is null/empty): Force unified view\n- **Deleted file** (new_content is null/empty): Force unified view\n- **Modified file**: Allow user to choose split/unified (current behavior)\n\n## UI Changes\n1. Detect if file is add/delete based on content\n2. Override `diffDisplayMode` to 'unified' for these cases\n3. Disable (grey out) the Split/Unified toggle buttons\n4. Optionally show tooltip: \"Split view not available for new/deleted files\"\n\n## Acceptance Criteria\n- New files always render in unified view\n- Deleted files always render in unified view\n- Toggle buttons are visually disabled (not hidden)\n- Modified files still respect user's split/unified preference\n- No flicker when switching between file types","priority":1,"completed":true,"result":"Implemented forced unified view for new/deleted files. Added 5 tests. Refactored DiffView to reduce complexity by extracting DiffContent, DiffPlaceholder, and DiffError components.","metadata":{"commit":{"sha":"8358812","message":"Force unified view for new/deleted files","branch":"main","timestamp":"2026-02-09T21:36:18.096Z"}},"created_at":"2026-02-09T21:33:31.683Z","updated_at":"2026-02-09T21:36:18.099Z","started_at":"2026-02-09T21:36:18.098Z","completed_at":"2026-02-09T21:36:18.099Z","blockedBy":[],"blocks":[],"children":[]}
{"id":"vmwmajl6","parent_id":null,"name":"Changes view: diff baseline toggle (HEAD vs Index)","description":"Allow users to choose what to diff working changes against:\n- HEAD (current default): shows all uncommitted changes\n- Index (staged): shows only unstaged changes\n\nThis is useful for reviewing what's about to be committed vs what's still in progress.\n\nUI: Could be a small toggle in the diff view header or a keyboard shortcut.\n\nLow priority - current HEAD-based diff covers most use cases.","priority":1,"completed":false,"result":null,"metadata":null,"created_at":"2026-02-09T00:51:43.009Z","updated_at":"2026-02-09T00:51:43.009Z","started_at":null,"completed_at":null,"blockedBy":[],"blocks":[],"children":[]}
{"id":"w14j4ruf","parent_id":null,"name":"Keyboard shortcut for split/unified diff toggle","description":"## Problem\nToggling between split and unified diff view requires clicking the buttons.\n\n## Solution\nAdd a keyboard shortcut to toggle view mode.\n\n## Implementation\n1. Add global keyboard listener for the shortcut (e.g., Cmd+D or Cmd+/)\n2. Toggle between 'split' and 'unified' in the diff view state\n3. Show shortcut hint in the toggle buttons' tooltip\n\n## Suggested Shortcuts\n- Cmd+\\ (backslash) - toggle split\n- Or Cmd+D for 'diff mode'\n\n## Acceptance Criteria\n- Keyboard shortcut toggles view mode\n- Works regardless of which panel is focused\n- Shortcut displayed in button tooltip","priority":1,"completed":false,"result":null,"metadata":null,"created_at":"2026-02-08T22:32:38.532Z","updated_at":"2026-02-08T22:32:38.532Z","started_at":null,"completed_at":null,"blockedBy":[],"blocks":[],"children":[]}
{"id":"xbvazlcz","parent_id":null,"name":"Add syntax highlighting to diff view","description":"## Problem\nDiff view shows plain text without syntax highlighting, making code harder to read.\n\n## Solution\nAdd syntax highlighting based on file extension. The react-diff-viewer-continued library supports this via the `highlightLines` prop or by pre-processing content.\n\n## Options\n1. **Prism.js** - Lightweight, many languages\n2. **highlight.js** - Similar to Prism\n3. **Shiki** - VSCode-quality highlighting, uses TextMate grammars\n\n## Implementation\n1. Detect language from file extension\n2. Apply syntax highlighting to old/new content before passing to diff viewer\n3. Ensure highlighting works with both split and unified views\n4. Handle unknown file types gracefully (no highlighting)\n\n## Acceptance Criteria\n- Common languages highlighted (JS/TS, Rust, Python, CSS, HTML, JSON, etc.)\n- Highlighting respects light/dark theme\n- Unknown file types display without errors","priority":1,"completed":true,"result":"Implemented syntax highlighting using Prism.js. Created language detection utility, highlighting function, and GitHub-inspired CSS theme supporting light/dark modes. Supports JS/TS, Rust, Python, Go, CSS, HTML, JSON, YAML, and more. Added 20 tests.","metadata":{"commit":{"sha":"d1ec9f6","message":"Add GitHub-inspired syntax highlighting theme","branch":"main","timestamp":"2026-02-09T21:10:56.250Z"}},"created_at":"2026-02-08T22:32:13.506Z","updated_at":"2026-02-09T21:10:56.253Z","started_at":"2026-02-09T21:10:56.252Z","completed_at":"2026-02-09T21:10:56.253Z","blockedBy":[],"blocks":[],"children":[]}
{"id":"xnu23piy","parent_id":null,"name":"Keyboard navigation with panel focus","description":"## Problem\nUsers can't navigate the app with keyboard - must use mouse for everything.\n\n## Solution\nImplement panel focus system and keyboard navigation.\n\n## Focus System\n- Track which panel is focused: 'commits' | 'files' | 'diff'\n- Visual indicator for focused panel (subtle border or background)\n- Left/Right arrows (or Tab) move focus between panels\n- Click on panel also focuses it\n\n## Navigation Within Panels\n**Commit list (when focused):**\n- Up/Down or Ctrl+P/Ctrl+N: move through commits\n- Enter: select commit (triggers auto-select first file)\n\n**File list (when focused):**\n- Up/Down or Ctrl+P/Ctrl+N: move through files\n- Enter: select file\n\n**Diff view (when focused):**\n- Could support scrolling with j/k in future\n\n## Implementation\n1. Add `focusedPanel` to store\n2. Create keyboard event handler (useEffect with keydown listener)\n3. Add visual focus indicator to panel headers\n4. Implement navigation logic for each panel\n\n## Acceptance Criteria\n- Arrow keys navigate within focused panel\n- Ctrl+P/N work as alternative (Emacs style)\n- Left/Right move focus between panels\n- Visual indicator shows which panel is focused\n- Selecting item with keyboard works same as click","priority":1,"completed":false,"result":null,"metadata":null,"created_at":"2026-02-08T22:32:31.681Z","updated_at":"2026-02-08T22:32:31.681Z","started_at":null,"completed_at":null,"blockedBy":[],"blocks":[],"children":[]}
